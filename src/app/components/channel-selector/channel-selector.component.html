<div class="channel-selector">
  <!-- Floating Remote Button -->
  <button class="remote-button" (click)="toggleMenu()" [class.active]="isMenuOpen()">
    <i class="bi bi-dpad-fill"></i>
  </button>

  <!-- Side Menu (Remote Body) -->
  <div class="menu-overlay" [class.hidden]="!isMenuOpen()" (click)="toggleMenu()"></div>
  <div class="side-menu vintage-texture-bg" [class.open]="isMenuOpen()" (click)="$event.stopPropagation()">

    <!-- Vintage Header -->
    <div class="remote-header">
      <img src="images/nmtv-logo.png" alt="NMTV" class="brand-logo" (click)="onLogoClick()">

      <div class="power-off-container">
        <div class="green-dot"></div>
        <button class="power-off-button retro-round-button" (click)="turnOff()" tabindex="0">
          <i class="bi bi-power"></i>
        </button>
        <span class="power-off-text">Power</span>
      </div>

      <span class="model-text">STEREO SOUND</span>
    </div>

    <div class="channel-list retro-inset-panel">
      @for (channel of channels(); track channel.id) {
      <button class="channel-item retro-button" [class.active]="isActive(channel.id)"
        [class.loading]="channel.isEasterEgg && isLoadingNoa()"
        [disabled]="channel.isEasterEgg && !isNoaChannelReady()"
        (click)="selectChannel(channel.id)" tabindex="0">
        <span class="channel-icon">{{ channel.icon }}</span>
        <span class="channel-name">{{ channel.name }}</span>
        @if (channel.isEasterEgg && isLoadingNoa()) {
        <span class="channel-loader">
          <i class="bi bi-arrow-clockwise spinner"></i>
        </span>
        }
      </button>
      }
    </div>

    <div class="menu-actions">
      <button class="settings-button retro-button" (click)="openSettings()" tabindex="0">
        <i class="bi bi-tools settings-icon"></i>
        <span class="settings-text">Mix Master</span>
      </button>
      <button class="about-button retro-button" (click)="openAbout()" tabindex="0">
        <i class="bi bi-lightbulb about-icon"></i>
        <span class="about-text">Unpack NMTV</span>
      </button>

      <button class="old-tv-button retro-button" (click)="toggleOldTV()" [class.active]="oldTVEnabled()" tabindex="0">
        <div class="toggle-content">
          <i class="bi bi-magic old-tv-icon"></i>
          <span class="old-tv-text">Vintage</span>
        </div>
        <div class="toggle-switch">
          <div class="toggle-track">
            <div class="toggle-thumb"></div>
          </div>
        </div>
      </button>

      @if (shouldShowFullScreen()) {
      <button class="fullscreen-button retro-button" (click)="toggleFullscreen()" [class.active]="isFullscreen()"
        tabindex="0">
        <div class="toggle-content">
          <i class="bi bi-arrows-fullscreen fullscreen-icon"></i>
          <span class="fullscreen-text">Fullscreen</span>
        </div>
        <div class="toggle-switch">
          <div class="toggle-track">
            <div class="toggle-thumb"></div>
          </div>
        </div>
      </button>
      }
    </div>

    <div class="d-pad-actions-container">
      <button class="support-button retro-small-button" (click)="openSupport()" tabindex="0">
        <i class="bi bi-cup-hot-fill"></i>
        <span>Support</span>
      </button>

      <div class="d-pad-spacer"></div>

      @if (showInstallButton()) {
      <button class="install-button retro-small-button" (click)="installApp()" tabindex="0">
        <i class="bi bi-download"></i>
        <span>App</span>
      </button>
      } @else {
      <button class="share-button retro-small-button" (click)="shareApp()" tabindex="0">
        <i class="bi bi-share-fill"></i>
        <span>Share</span>
      </button>
      }
    </div>
  </div>

  <!-- Modals -->
  <app-settings-modal></app-settings-modal>
  <app-about-modal></app-about-modal>
  <app-install-modal></app-install-modal>
</div>