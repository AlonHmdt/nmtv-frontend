<div class="settings-modal" [class.open]="isOpen()">
  @if (isOpen()) {
    <!-- Overlay -->
    <div class="modal-overlay" (click)="close()"></div>
    
    <!-- Modal Content -->
    <div class="modal-content" (click)="$event.stopPropagation()">
      <!-- Header -->
      <div class="modal-header">
        <h2>âš™ï¸ Custom Playlists</h2>
        <button class="close-button" (click)="close()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="4" y1="4" x2="16" y2="16"/>
            <line x1="16" y1="4" x2="4" y2="16"/>
          </svg>
        </button>
      </div>

      <!-- Channel Tabs -->
      <div class="channel-tabs">
        @for (channel of channels; track channel.id) {
          <button 
            class="channel-tab"
            [class.active]="isChannelActive(channel.id)"
            (click)="selectChannel(channel.id)">
            <span class="channel-icon">{{ channel.icon }}</span>
            <span class="channel-name">{{ channel.name }}</span>
            @if (customPlaylistService.getChannelCount(channel.id) > 0) {
              <span class="playlist-badge">{{ customPlaylistService.getChannelCount(channel.id) }}</span>
            }
          </button>
        }
      </div>

      <!-- Content Area -->
      <div class="modal-body">
        <!-- Info Message - Condensed for landscape -->
        <div class="info-message">
          <p>
            <strong>Add your own YouTube playlists!</strong> Your custom playlists will make up 50% of the videos played.
          </p>
          <p class="limit-info">
            Only Public playlists are supported and just the first <strong>100 videos</strong> per playlist will be used. 
          </p>
        </div>

        <!-- Two Column Layout for Landscape -->
        <div class="content-columns">
          <!-- Left Column: Current Playlists -->
          <div class="playlists-section">
          <h3>
            Custom Playlists 
            <span class="count">({{ playlistCount() }}/5)</span>
          </h3>

          @if (currentPlaylists().length === 0) {
            <div class="empty-state">
              <p>No custom playlists yet. Add one below!</p>
            </div>
          } @else {
            <div class="playlists-list">
              @for (playlist of currentPlaylists(); track playlist.id) {
                <div class="playlist-item">
                  <div class="playlist-info">
                    <span class="playlist-icon">ğŸ“‹</span>
                    <div class="playlist-details">
                      <span class="playlist-name">{{ playlist.name }}</span>
                      <a 
                        [href]="'https://www.youtube.com/playlist?list=' + playlist.id" 
                        target="_blank"
                        class="playlist-link">
                        View on YouTube â†—
                      </a>
                    </div>
                  </div>
                  <button 
                    class="delete-button"
                    (click)="removePlaylist(playlist.id)"
                    title="Remove playlist">
                    ğŸ—‘ï¸
                  </button>
                </div>
              }
            </div>
          }
        </div>

        <!-- Right Column: Add Playlist Form -->
        <div class="add-form-section">
          @if (canAddMore()) {
            <div class="add-playlist-section">
              <h3>Add New Playlist</h3>
              <div class="input-group">
                <input 
                  type="text"
                  class="playlist-input"
                  [(ngModel)]="playlistUrl"
                  placeholder="Paste YouTube playlist URL..."
                  [disabled]="isAdding()"
                  (keyup.enter)="validateAndAdd()">
                <button 
                  class="add-button"
                  (click)="validateAndAdd()"
                  [disabled]="isAdding() || !playlistUrl()">
                  {{ isAdding() ? 'Adding...' : 'Add' }}
                </button>
              </div>
              
              @if (errorMessage()) {
                <div class="error-message">
                  âŒ {{ errorMessage() }}
                </div>
              }

              <div class="url-examples">
                <p><strong>Example:</strong></p>
                <code>https://www.youtube.com/playlist?list=PLxxxxxx</code>
              </div>
            </div>
          } @else {
            <div class="max-reached">
              <p>âœ‹ Maximum of 5 playlists reached.</p>
              <p>Remove a playlist to add a new one.</p>
            </div>
          }
        </div>
        </div>
      </div>

      <!-- Modal Footer with Apply Button -->
      <div class="modal-footer">
        <button 
          class="apply-button"
          (click)="applyChanges()"
          [disabled]="isApplying()">
          @if (isApplying()) {
            <span class="spinner">â³</span>
            <span>Applying Changes...</span>
          } @else {
            <span>âœ“ Apply & Reload Videos</span>
          }
        </button>
      </div>
    </div>
  }
</div>
